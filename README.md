# telegram-bot
Телеграм-бот для работы с балансом пользователей.
Функционал:
- Регистрация пользователя при первом сообщении: 
При первом обращении пользователя к боту, создается его учётная запись в базе данных с начальным балансом $0.00. 

- Если сообщение, которое пользователь отправляет боту, является числом, 
то соответствующая сумма в долларах начисляется ему на счёт. 
Если число отрицательное, то сумма наоборот списывается. 
В ответ пользователю должно отправляться сообщение с остатком на его счёте.

- Пользователь может отправить число с отделением дробной части как точкой, так и запятой.

- На счету у пользователя не может быть отрицательной суммы. 
Если пользователь пытается списать больше, чем у него есть, то в ответ получет сообщение об ошибке.

## Структура проекта
Проект состоит из нескольких компонентов:

1. PHP Bot: обрабатывает запросы от Telegram и взаимодействует с базой данных.
1. MySQL: хранит информацию о пользователях и их балансах.
1. Adminer: веб-интерфейс для управления базой данных.
## Требования
Для разворачивания проекта необходимы:

1. Docker
1. Docker Compose
## Инструкция по локальной установке
1. Клонируйте проект на вашу машину:

```bash
git clone https://github.com/Mikhail-Konyukhov/telegram-bot/
cd <папка_с_проектом>
```
1. В файле config.txt укажите токен своего бота
TELEGRAM_BOT_TOKEN=your_telegram_bot_token

1. Соберать и запустить контейнеры с помощью Docker Compose:

```bash
docker-compose up --build
```
После запуска контейнеров:

PHP Bot будет доступен по адресу: http://localhost:8081
MySQL будет работать на порту 3306
Adminer будет доступен по адресу: http://localhost:8080

## Настроить вебхук через ngrok

1. **Установить ngrok**:
   Скачать ngrok с [официального сайта](https://ngrok.com/download).

2. **Запустите ngrok**:
   Откройте терминал и запустите ngrok на порту указанном для php-bot в docker-compose.yml:

   ```bash
   ngrok http 8081
   ```
   ngrok выдаст публичный url

3. **Настройте вебхук**
   Используйте команду setWebhook, чтобы настроить вебхук для вашего бота, подставив публичный URL от ngrok:

```bash
https://api.telegram.org/bot<YOUR_TOKEN>/setWebhook?url=<NGROK_URL>/index.php
```
